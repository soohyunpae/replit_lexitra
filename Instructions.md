좋아, 현재 Lexitra의 “업로드 시 처리 지연 문제”를 해결하기 위한 구조 개선안을 정리해서 아래 문서 형식으로 정리해줄게.

⸻

📄 Lexitra 파일 처리 구조 개선안

✅ 현재 구조 (문제점 포함)

단계	작업 내용	문제점
① 파일 업로드	문서 저장	빠름
② 파싱 + TM 매칭 + GPT 번역	모든 처리 동시에 수행	처리 시간이 길어 UI가 멈춘 것처럼 보임
③ 화면 표시	번역 결과 표시	전 단계 완료까지 기다려야 하므로 사용자 경험 나쁨


⸻

🚀 개선 후 구조 (단계 분리 + 비동기 처리)

단계	작업 내용	실행 시점
① 파일 업로드	문서 저장	업로드 즉시
② 전처리 (파싱/세그먼트 추출)	원문만 추출	업로드 직후 빠르게 처리
③ 화면 표시	원문만 먼저 렌더링	사용자 즉시 확인 가능
④ TM 매칭 + GPT 번역	번역 버튼 클릭 시 실행	프론트에서 요청 후 백엔드 비동기 처리
⑤ 상태 UI 표시	진행 중 상태 / 완료 알림	사용자 경험 개선


⸻

🛠 작업 항목 (백엔드 중심)

1. API 분리 및 비동기 처리

API	설명
POST /api/initialize_project	파일 파싱 및 세그먼트 추출만 수행
POST /api/translate_all	TM 매칭 및 GPT 번역 (chunk 단위로 병렬 처리 가능)
POST /api/translate_segment	특정 세그먼트만 GPT 번역 (수동 번역 기능 대응)


⸻

2. 프론트 구조 수정
  •	프로젝트 열람 시 원문 세그먼트만 우선 표시
  •	“전체 번역 실행” 버튼 추가 (클릭 시 백엔드 요청)
  •	번역 진행 상황 표시: 로딩 아이콘 또는 진행률 바
  •	번역 완료 후 자동으로 결과 렌더링

⸻

3. 타임아웃 및 성능 대응
  •	GPT 요청은 10~20세그먼트 단위로 병렬 처리
  •	각 GPT 요청 처리 후 DB에 저장 → 상태 업데이트
  •	서버에서 응답 시간이 10초 이상 걸리는 요청은 반드시 쪼개야 함

⸻

📌 보너스 UX 개선 사항 (선택 사항)

  •	로딩 중인 세그먼트는 흐리게 표시하거나 스켈레톤 UI 활용

